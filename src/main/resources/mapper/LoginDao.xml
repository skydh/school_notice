<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yyf.school.login.dao.LoginDao">
	<!-- 目的：为DAO接口提供sql语句配置 <update id="reduceNumber"> update seckill set number=number-1 
		where seckill_id = #{seckillId} </update> -->

	<select id="IsUser" resultType="com.yyf.school.login.vo.AllRoleVO"
		parameterType="String">
		select
		a.id ,b.case_school
		from all_user a inner join all_role on a.id=b.p_id
		where
		a.user_name=
		#{username} and a.password=#{password}
	</select>
	<!-- parameterType=“int” 多个参数的话可以不用给 <select id="queryAll" resultType="Seckill"> 
		select seckill_id,name,number,start_time,end_time,create_time from seckill 
		order by create_time desc limit #{offset},#{limit} </select> -->

	<insert id="register" parameterType="User">
		<!-- 主键冲突 报错 -->
		insert ignore into all_user(id,user_name,password)
		values
		(#{id},#{userName},#{password})
	</insert>
	<insert id="insertAllData" parameterType="AllRoleVO">
		insert ignore into
		all_role(id,p_id,school_code,college_code,grade_code,class_code,case_school,contend)
		values
		VALUES(#{id}, #{pId}, #{schoolCode}, #{collegeCode},
		#{gradeCode}, #{classCode}, #{caseSchool}, #{contend})
	</insert>



	<update id="updateAllData" parameterType="AllRoleVO">
		update
		all_role set
		school_code=#{schoolCode},grade_code=#{gradeCode},class_code=#{classCode},
		case_school=#{caseSchool},contend=#{contend}
		WHERE
		p_id =
		#{id}
	</update>

	<update id="doApprove">
		update
		all_role set
		is_allow=#{state}
		WHERE
		p_id in
		#{ids}
	</update>

	<select id="findActiveBlogLike" resultType="Blog">
		SELECT * FROM all_role WHERE state = ‘ACTIVE’
		<choose>
			<when test="title != null">
				AND title like #{title}
			</when>
			<when test="author != null and author.name != null">
				AND author_name like #{author.name}
			</when>
			<otherwise>
				AND featured = 1
			</otherwise>
		</choose>
	</select>


</mapper>